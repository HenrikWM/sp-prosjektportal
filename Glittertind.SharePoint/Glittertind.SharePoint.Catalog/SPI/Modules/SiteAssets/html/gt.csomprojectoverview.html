
<link rel="stylesheet" type="text/css" href="../_layouts/15/1044/styles/Themable/searchv15.css">
<script type="text/javascript" src="../SiteAssets/gt/js/knockout-3.1.0.js"></script>
<link rel="stylesheet" type="text/css" href="../SiteAssets/gt/css/KoGrid.css">

<style type="text/css">

</style>

<script type="text/javascript" language="javascript">

    GT.Project.Model.appViewModel.gridOptions = {
        data: GT.Project.Model.appViewModel.projects
    };

    (function () {

        GT.jQuery(document).ready(function () {

            SP.SOD.executeOrDelayUntilScriptLoaded(function () {
                warningDate = new Date();
                warningDate.setDate(warningDate.getDate() - 60);
                var filter = { lastChanged: warningDate, statusRisk: "høy", statusTime: "etter plan", statusBudget: "over budsjett" };

                //Høy risiko, etter plan, over budsjett (eller 'vet ikke') og siste endret er eldre enn 2 måneder og fase != realisere

                GT.Project.get_allProjectsUnderCurrent().done(function () {
                    GT.Project.Model.appViewModel.filter(filter);
                });
                ko.applyBindings(GT.Project.Model.appViewModel);
            }, "sp.js");
        });
    })();



</script>


<div id="gt-csomprojectdir-outz">

    <div id="grid" class="gridStyle"></div>

    <h1>Prosjekter som krever tilsyn</h1>

    <table class="gt-result-table" id="gt-result-table1">
        <thead>
            <tr>
                <th>Tittel</th>
                <th>Effektmål</th>
                <th>Prosjekteier</th>
                <th>Prosjektleder</th>
                <th>Status tid</th>
                <th>Status risiko</th>
                <th>Status budsjett</th>
                <th>Fase</th>
                <th>Sist endret</th>
            </tr>
        </thead>
        <tbody data-bind="foreach: projects(), visible: loaded()" style="display: none;">
            <tr data-bind="visible: matchesFilter(), css: {'ms-HoverBackground-bgColor': $index() % 2 == 0}">
                <td><a href="" data-bind="text: title(), attr:{href: url()}"></a></td>
                <td data-bind="text: projectGoal()"></td>
                <td data-bind="text: projectOwner()"></td>
                <td data-bind="text: projectManager()"></td>
                <td data-bind="text: statusTime(), css: statusTimeCss()"></td>
                <td data-bind="text: statusRisk(), css: statusRiskCss()"></td>
                <td data-bind="text: statusBudget(), css: statusBudgetCss()"></td>
                <td data-bind="text: phase()"></td>
                <td data-bind="text: lastChangedDisplayValue()"></td>
            </tr>
        </tbody>
    </table>
    <div data-bind="visible: !loaded()" style="display: none;" class="loadingSpinner">
        <img src="/_layouts/15/images/gears_anv4.gif?rev=38" />   laster inn data ...
    </div>

    <br />
    <br />

    <h1>Porteføljeoversikt</h1>

    <table class="display gt-result-table" id="gt-result-table2" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th>Tittel</th>
                <th>Effektmål</th>
                <th>Prosjekteier</th>
                <th>Prosjektleder</th>
                <th>Status tid</th>
                <th>Status risiko</th>
                <th>Status budsjett</th>
                <th>Fase</th>
                <th>Sist endret</th>
            </tr>
        </thead>
        <tbody data-bind="foreach: projects(), visible: loaded()" style="display: none;">
            <tr data-bind="css: {'ms-HoverBackground-bgColor': $index() % 2 == 0}">
                <td><a href="" data-bind="text: title(), attr:{href: url()}"></a></td>
                <td data-bind="text: projectGoal()"></td>
                <td data-bind="text: projectOwner()"></td>
                <td data-bind="text: projectManager()"></td>
                <td data-bind="text: statusTime(), css: statusTimeCss()"></td>
                <td data-bind="text: statusRisk(), css: statusRiskCss()"></td>
                <td data-bind="text: statusBudget(), css: statusBudgetCss()"></td>
                <td data-bind="text: phase()"></td>
                <td data-bind="text: lastChangedDisplayValue()"></td>
            </tr>
        </tbody>
    </table>
    <div data-bind="visible: !loaded()" style="display: none;" class="loadingSpinner">
        <img src="/_layouts/15/images/gears_anv4.gif?rev=38" />   laster inn data ...
    </div>
</div>